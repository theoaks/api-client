/*! theoaksoft-api-client 2019-11-21 */

!function(e,t){"use strict";if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t(e,require("lodash"));else if("function"==typeof define&&define.amd)define([e,"lodash"],t);else{if(void 0===e._)throw Error("ApiClient requires lodash");e.ApiClient=t(e,e._),e.OaksEncryptor=e.ApiClient}}("undefined"!=typeof window?window:this,function(e,t){"use strict";const o={get:"GET",post:"POST",put:"PUT",delete:"DELETE"};function s(e){var t="There's a server connection currently active. If you close this window, you will lose the progress made";return e.returnValue=t,t}function r(e,t,o){this.apiUrlBase=e,this.authToken=t}return r.prototype={appId:null,deviceId:null,setServerTimeout(e){this.serverTimeout=NaN!==Number(e)?Number(e):null},sendForm:function(t,r,n,a){var i=this;return new Promise(function(a,u){var l=n.method||o.post,d=n;e.onbeforeunload=s,d instanceof FormData||(d=new FormData(n));n.enctype;"multipart/form-data"===n.enctype&&("multipart/form-data; charset=utf-8; boundary="+Math.random().toString().substr(2),l=o.post);var c=i.buildUrl(t,r);if(l.toUpperCase()===o.get){var p=[];for(var h in d.entries())p.push(encodeURIComponent(h[0])+"="+encodeURIComponent(h[1]));c=c+"?"+p.join("&")}var f=new XMLHttpRequest;f.onload=function(){var t=f.responseText;e.onbeforeunload=null;var o=JSON.parse(t);this.status>=200&&this.status<300?a(o):u(o)},f.onerror=function(){try{var e=JSON.parse(f.statusText)}catch(t){e={success:!1,message:f.statusText,data:null}}u(e)},f.open(l.toUpperCase(),c),null!=i.authToken&&f.setRequestHeader("Authorization",`Bearer ${i.authToken}`),f.setRequestHeader("Accept","application/json"),f.setRequestHeader("Oaks-Request-Source","xmlhttprequest"),f.setRequestHeader("Oaks-Origin-Host",location.protocol+"//"+location.host),f.setRequestHeader("Oaks-Origin-Url",location.href),f.withCredentials=!0,l.toLowerCase()===o.get.toLowerCase()?f.send():f.send(d)})},send(r,n,a){var i=this,u=this.buildUrl(r,n);e.onbeforeunload=s;var l=t.defaultsDeep(a,{method:"post",data:null});return new Promise((t,s)=>{var r=new XMLHttpRequest,n=l.data;if(r.onload=(()=>{var o=r.responseText;e.onbeforeunload=null;try{var n=JSON.parse(o);r.status>=200&&r.status<300?t(n):(n.statusCode=r.statusCode,s(n))}catch(e){s({success:!1,message:e,statusCode:r.statusCode})}}),r.onerror=(()=>{try{var e=JSON.parse(r.statusText)}catch(t){console.error(t),e={success:!1,message:r.statusText,data:null}}e.statusCode=r.statusCode,s(e)}),this.serverTimeout>0&&(r.ontimeout=(()=>{s({success:!1,message:"The server did not respond on time. You might need to try again later."})})),l.method.toLowerCase()===o.get.toLowerCase()){var a=[];for(var d in n)null!==n[d]&&n.hasOwnProperty(d)&&a.push(encodeURIComponent(d)+"="+encodeURIComponent(n[d]));a.length>0&&(u=u+"?"+a.join("&"))}r.open(l.method.toUpperCase(),u),null!=this.authToken&&r.setRequestHeader("Authorization",`Bearer ${i.authToken}`),r.setRequestHeader("Accept","application/json"),r.setRequestHeader("Oaks-Request-Source","xmlhttprequest"),r.setRequestHeader("Oaks-Origin-Host",location.protocol+"//"+location.host),r.setRequestHeader("Oaks-Origin-Url",location.href),r.withCredentials=!0;try{"get"===l.method.toLowerCase()?r.send():(r.setRequestHeader("Content-Type","application/json"),r.send(JSON.stringify(n)))}catch(e){s({success:!1,message:"Unable to connect to the server."})}})},buildUrl(e,t){return this.apiUrlBase+"/"+e+"/"+t},isFunction:e=>"function"==typeof e,isObject:e=>"object"==typeof e},console.log(r),r});